<!DOCTYPE html>
<html>
<!-- THIS FILE WAS GENERATED BY A SCRIPT: DO NOT EDIT IT! -->
    <head>
        <meta charset="UTF-8">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
        <link rel="stylesheet" href="../style.css">

        <!-- jQuery CDN -->
         <script src="https://code.jquery.com/jquery-1.12.0.min.js"></script>
         <!-- Bootstrap Js CDN -->
         <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

         <script type="text/javascript">
             var status = 'on';
             $(document).ready(function () {
                 $('#sidebarCollapse').on('click', function () {
                     $('#sidebar').toggleClass('active');
                     if (status == 'on') {
                         $('#sidebarText').text("Expand Side Nav");
                         status = 'off';
                     } else {
                         $('#sidebarText').text("Collapse Side Nav");
                         status = 'on';
                     }
                 });
             });
         </script>
        <title>
            Kubernetes
        </title>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-114841175-1"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'UA-114841175-1');
</script>
    </head>
    <body>
        <div class="wrapper">
<!-- Sidebar Holder -->
<nav id="sidebar">
    <div id="sidebarCollapse">
        <div class="sidebar-header">
            <h1>DevOps</h1>
            <strong>DO</strong>
        </div>
    </div>

    <ul class="list-unstyled components">
        <li>
            <a href="https://gcallah.github.io/DevOps/index.html">
                <i class="glyphicon glyphicon-home"></i>
                Home
            </a>
        </li>
        <li>
            <a href="#pageSubmenu" data-toggle="collapse" aria-expanded="false">
                <i class="glyphicon glyphicon-duplicate"></i>
                Main Areas of Coverage
            </a>
            <ul class="collapse list-unstyled" id="pageSubmenu">
                <li>
                  <a href="#BuildSubmenu" data-toggle="collapse" aria-expanded="false">Build</a>
                  <ul class="collapse list-unstyled" id="BuildSubmenu">
                    <li><a href="https://gcallah.github.io/DevOps/build/links.html">Build links</a></li>
                    <li><a href="https://gcallah.github.io/DevOps/build/theory.html">Build theory</a></li>
                    <li><a href="https://gcallah.github.io/DevOps/build/tools.html">Build tools</a></li>
                    <li><a href="https://gcallah.github.io/DevOps/build/implementation.html">Our build implementation</a></li>
                  </ul>
                </li>
                <li>
                  <a href="#CloudSubmenu" data-toggle="collapse" aria-expanded="false">Cloud</a>
                  <ul class="collapse list-unstyled" id="CloudSubmenu">
                    <li><a href="https://gcallah.github.io/DevOps/cloud/links.html">Cloud links</a></li>
                    <li><a href="https://gcallah.github.io/DevOps/cloud/theory.html">Cloud theory</a></li>
                    <li><a href="https://gcallah.github.io/DevOps/cloud/tools.html">Cloud tools</a></li>
                    <li><a href="https://gcallah.github.io/DevOps/cloud/implementation.html">Our cloud implementation</a></li>
                  </ul>
                </li>
                <li>
                  <a href="#CodingSubmenu" data-toggle="collapse" aria-expanded="false">Coding: Lean and Agile Practices</a>
                  <ul class="collapse list-unstyled" id="CodingSubmenu">
                    <li><a href="https://gcallah.github.io/DevOps/coding/links.html">Coding links</a></li>
                    <li><a href="https://gcallah.github.io/DevOps/coding/theory.html">Coding theory</a></li>
                    <li><a href="https://gcallah.github.io/DevOps/coding/tools.html">Coding tools</a></li>
                    <li><a href="https://gcallah.github.io/DevOps/coding/implementation.html">Our coding implementation</a></li>
                  </ul>
                </li>
                <li>
                  <a href="#DeploySubmenu" data-toggle="collapse" aria-expanded="false">Deployment</a>
                  <ul class="collapse list-unstyled" id="DeploySubmenu">
                    <li><a href="https://gcallah.github.io/DevOps/deployment/links.html">Deployment links</a></li>
                    <li><a href="https://gcallah.github.io/DevOps/deployment/theory.html">Deployment theory</a></li>
                    <li><a href="https://gcallah.github.io/DevOps/deployment/tools.html">Deployment tools</a></li>
                    <li><a href="https://gcallah.github.io/DevOps/deployment/implementation.html">Our deployment implementation</a></li>
                  </ul>
                </li>
                <li>
                  <a href="#MonitorSubmenu" data-toggle="collapse" aria-expanded="false">Monitoring</a>
                  <ul class="collapse list-unstyled" id="MonitorSubmenu">
                    <li><a href="https://gcallah.github.io/DevOps/monitoring/links.html">Monitoring links</a></li>
                    <li><a href="https://gcallah.github.io/DevOps/monitoring/theory.html">Monitoring theory</a></li>
                    <li><a href="https://gcallah.github.io/DevOps/monitoring/tools.html">Monitoring tools</a></li>
                    <li><a href="https://gcallah.github.io/DevOps/monitoring/implementation.html">Our monitoring implementation </a></li>
                  </ul>
                </li>
                <li>
                  <a href="#SecuritySubmenu" data-toggle="collapse" aria-expanded="false">Security: Rugged DevOps</a>
                  <ul class="collapse list-unstyled" id="SecuritySubmenu">
                    <li><a href="https://gcallah.github.io/DevOps/security/links.html">Security links</a></li>
                    <li><a href="https://gcallah.github.io/DevOps/security/theory.html">Security theory</a></li>
                    <li><a href="https://gcallah.github.io/DevOps/security/tools.html">Security tools</a></li>
                    <li><a href="https://gcallah.github.io/DevOps/security/implementation.html">Our security implementation</a></li>
                  </ul>
                </li>
                <li>
                  <a href="#TestingSubmenu" data-toggle="collapse" aria-expanded="false">Testing</a>
                  <ul class="collapse list-unstyled" id="TestingSubmenu">
                    <li><a href="https://gcallah.github.io/DevOps/testing/links.html">Testing links</a></li>
                    <li><a href="https://gcallah.github.io/DevOps/testing/theory.html">Testing theory</a></li>
                    <li><a href="https://gcallah.github.io/DevOps/testing/tools.html">Testing tools</a></li>
                    <li><a href="https://gcallah.github.io/DevOps/testing/implementation.html">Our testing implementation</a></li>
                  </ul>
                </li>
                <li>
                  <a href="#WorkflowSubmenu" data-toggle="collapse" aria-expanded="false">Workflow: DevOps as a Way of Work</a>
                  <ul class="collapse list-unstyled" id="WorkflowSubmenu">
                    <li><a href="https://gcallah.github.io/DevOps/workflow/links.html">Workflow links</a></li>
                    <li><a href="https://gcallah.github.io/DevOps/workflow/theory.html">Workflow theory</a></li>
                    <li><a href="https://gcallah.github.io/DevOps/workflow/tools.html">Workflow tools</a></li>
                    <li><a href="https://gcallah.github.io/DevOps/workflow/implementation.html">Our workflow implementation</a></li>
                  </ul>
                </li>
                <li>
                  <a href="#UXSubmenu" data-toggle="collapse" aria-expanded="false">UX: User Interface</a>
                  <ul class="collapse list-unstyled" id="UXSubmenu">
                    <li><a href="https://gcallah.github.io/DevOps/UX/links.html">UX links</a></li>
                    <li><a href="https://gcallah.github.io/DevOps/UX/theory.html">UX theory</a></li>
                    <li><a href="https://gcallah.github.io/DevOps/UX/tools.html">UX tools</a></li>
                    <li><a href="https://gcallah.github.io/DevOps/UX/implementation.html">Our UX implementation</a></li>
                  </ul>
                </li>
            </ul>
        </li>
        <li>
            <a href="#MaterialsSubmenu" data-toggle="collapse" aria-expanded="false">
                <i class="glyphicon glyphicon-link"></i>
                Other Materials
            </a>
            <ul class="collapse list-unstyled" id="MaterialsSubmenu">
              <li>
                <a href="#CMSubmenu" data-toggle="collapse" aria-expanded="false">Course-specific Material</a>
                <ul class="collapse list-unstyled" id="CMSubmenu">
                  <li><a href="https://gcallah.github.io/DevOps/courseDescr.html">Course description, Spring 2018</a></li>
                  <li><a href="https://gcallah.github.io/DevOps/courseExpectations.html">Course expectations, Spring 2018</a></li>
                  <li><a href="https://gcallah.github.io/DevOps/TeamsTable.html">Our teams for Spring 2018</a></li>
                  <li><a href="https://gcallah.github.io/DevOps/books.html">DevOps reading list</a></li>
                  <li><a href="https://gcallah.github.io/DevOps/journals/index.html">Our DevOps journals</a></li>
                  <li>
                  <a href="http://www.thedevopscourse.com/quiz/">Our Django
                  site: we are creating a quiz system here.</a>
                  </li>
                  <li>
                    <a href="https://gcallah.pythonanywhere.com/berkeley/">
                        DevOps Bibliographic Search
                    </a>
                  </li>
                </ul>
              </li>
              <li>
                <a href="#SupSubmenu" data-toggle="collapse" aria-expanded="false">Supplementary Material</a>
                <ul class="collapse list-unstyled" id="SupSubmenu">
                  <li><a href="https://gcallah.github.io/DevOps/websites.html">DevOps websites</a></li>
                </ul>
              </li>
            </ul>
        </li>
        <li>
            <a href="https://gcallah.github.io/DevOps/about.html">
                <i class="glyphicon glyphicon-briefcase"></i>
                About
            </a>
        </li>
    </ul>
</nav>
        <div id="content">

        <h1>
            Kubernetes
        </h1>

        <h2>
            What?
        </h2>
        <p>
          "Is a deployment automation, scaling and management framwork for
          containerized applications"<br>
        </p>

        <img src="https://kubernetes.io/images/favicon.png"/>

        <h2>
            History?
        </h2>
        <p>
          <b>*</b> Kubernetes roots come from project Borg used for deployment
          automation at google.<br>
          <b>*</b> It is considered the most effective solution based on its success
          at Google running the search engine at a large scale.<br>
        </p>

        <h2>
            Why?
        </h2>
        <p>
        <b>The Problem: </b><br>
        <b>*</b> Containers (more here:<a>https://gcallah.github.io/DevOps/deployment/dockerSwarm.html</a>)
          simplied the deployment of an application or bringing up a service
          across various environments. When the application spans large scale
          or bed of users, A problem or challenge that arose is the management,
          recovery, scale, update of the container.<br>
        <b>The Solution: </b><br>
        <b>*</b> The elegant solution would be to build an automation framework
        that handles all of these requirements and maintains the service at
        scale.<br>
        <b>*</b> The solution had to schedule, measure and allocate resources for
        required applications, deploy and maintain them as a cluster service.<br>
        <b>*</b> The solution =&gt Kubernetes<br>
        </p>

        <h2>
            How?
        </h2>
        <p>
          * Master - Worker Design
        </p>

        <h2>
            Components:
        </h2>
        <p>
          <b>*</b> Kubernetes Cluster Service - Manage the pods, create, deploy,
          scale, recovery from the configuration<br>
          <b>*</b> Kubelet Process - communication between Kubernetes cluster
          service and workers<br>
          <b>*</b> Kubernetes API - Provision to talk to the container service<br>
          <b>*</b> Workers - nodes or machines to run the container<br>
          <b>*</b> Configuration<br>
            <b>*</b> Pods - a very basic or smallest unit of deployment<br>
        </p>

        <h2>
            Implementation:
        </h2>
        <p>
        <b>Kuberenets Locally</b><br>
        <b>*</b> Using MiniKube, a local kubernetes could be setup with a virtual
        machine like virutal box or vmware workstation.<br>
        <b>Basic Kubernetes Cluster Implementation as a Simple Project for
          the Course:</b><br>
        <b>*</b> Deploy the gcallah/DevOps static website as a cluster service with
        AWS or any machines in the cloud.<br>
        <b>*</b> Pod1 - git-sync(gcallah/devops) pulling latest updates + Pod2 - nginx
        container ==&gt Kubernetes Cluster Service ==&gt AWS Worker machines<br>
        </p>

        <h3>
            Setup:
        </h3>
        <p>
          <b>* Install minikube</b><br>
          <b>* Install any hypervisor like virtualbox or vmware</b><br>
        </p>

        <h3>
            Configuration:
        </h3>
        <p><b>*</b> Docker Compose used as a base and reference to create deployment
           and service configuration</p>
          <pre>
            <code>
                <span>
              # A Docker compose to create the application with two containers
              # * 1. Nginx container
              # * 2. git-sync container
              # Reference from: https://hub.docker.com/r/openweb/git-sync/
              # Run with `docker-compose up -d` once the dockerCompose
              file is created
              version: "2"
                services:
                  nginx:
                    image: nginx:latest
                    ports:
                      - "8080:80"
                    volumes:
                      - website_sources:/usr/share/nginx/html:z
                    depends_on:
                      - git-sync
                    restart: always
                  git-sync:
                    image: openweb/git-sync:0.0.1
                    environment:
                      GIT_SYNC_REPO: "https://github.com/gcallah/DevOps"
                      GIT_SYNC_DEST: "/git"
                      GIT_SYNC_BRANCH: "master"
                      GIT_SYNC_REV: "FETCH_HEAD"
                      GIT_SYNC_WAIT: "100"
                    volumes:
                      - website_sources:/git:z
                    restart: always
                volumes:
                  website_sources:
                driver: local
                </span>
            </code>
          </pre>


        <b>*</b><p> Used "kompose" <a href="https://github.com/kubernetes/kompose"/>
          to convert docker compose -&gt respective kubernetes deployment
          and service configuration. Use this command
          <b>./kompose convert -f ../docker-compose.yml </b> to get the configs.</p>
          <p><br><b> Deployment configuration </b></p>
            <pre>
              <code>
                <span>
                # Deployment YAML Configuration File
                # * Pod specification of using 2 containers with a shared volume
                # References:
                # * http://paulbakker.io/kubernetes/kubernetes-static-sites/
                # * https://github.com/dysinger/learn-minikube
                # * https://github.com/kubernetes/kompose
                kind: Deployment
                apiVersion: extensions/v1beta1
                metadata:
                  name: devopswebsite
                spec:
                  replicas: 2
                  template:
                    metadata:
                       labels:
                          app: devopswebsite
                    spec:
                      containers:
                      - image: nginx
                        name: nginx
                        ports:
                        - containerPort: 80
                        volumeMounts:
                        - mountPath: "/usr/share/nginx/html"
                          name: www
                          readOnly: true
                      - image: paulbakker/git-sync
                        name: git-sync
                        imagePullPolicy: Always
                        env:
                        - name: GIT_SYNC_REPO
                          value: https://github.com/gcallah/DevOps
                        - name: GIT_SYNC_WAIT
                          value: '10'
                        volumeMounts:
                        - mountPath: "/git"
                          name: www
                      volumes:
                      - name: www
                        emptyDir: {}
                    </span>
              </code>
            </pre>

          <p><br><b> Service configuration </b></p>
            <pre>
              <code>
                <span>
                apiVersion: v1
                kind: Service
                metadata:
                  name: devopswebsite
                spec:
                    type: NodePort
                    ports:
                      - name: http
                        port: 80
                        protocol: TCP
                    selector:
                        app: devopswebsite
                </span>
              </code>
            </pre>


        <h3>
            Steps:
        </h3>
        <p><br><b> Minikube Start </b></p>
          <pre>
            <code>
              <span>
              MacBook-Pro:devOps deployment$  minikube start
              There is a newer version of minikube available (v0.26.1).  Download it here:
              https://github.com/kubernetes/minikube/releases/tag/v0.26.1

              To disable this notification, run the following:
              minikube config set WantUpdateNotification false
              Starting local Kubernetes v1.9.4 cluster...
              Starting VM...
              Getting VM IP address...
              Moving files into cluster...
              Setting up certs...
              Connecting to cluster...
              Setting up kubeconfig...
              Starting cluster components...
              Kubectl is now configured to use the cluster.
              Loading cached images from config file.

              </span>
            </code>
          </pre>

          <p><br><b> Status Verification </b></p>
            <pre>
              <code>
                <span>
                  MacBook-Pro:devOps deployment$  kubectl get services
                  NAME         TYPE        CLUSTER-IP   EXTERNAL-IP   PORT(S)   AGE
                  kubernetes   ClusterIP   10.96.0.1    &gtnone&lt        443/TCP   4m

                  MacBook-Pro:devOps deployment$  kubectl get pods
                  No resources found.

                </span>
              </code>
            </pre>

          <p><br><b> Deploy Pods and Create Service </b></p>
              <pre>
                <code>
                  <span>
                    MacBook-Pro:devOps deployment$  kubectl create -f kubernetesFiles/staticWebServerDeployment.yaml
                    deployment.extensions "devopswebsite" created
                    MacBook-Pro:devOps deployment$  kubectl create -f kubernetesFiles/staticWebServerService.yaml
                    service "devopswebsite" created
                  </span>
                </code>
              </pre>

          <p><br><b> Deploy Pods and Create Service </b></p>
                  <pre>
                    <code>
                      <span>

                      </span>
                    </code>
                  </pre>



        <h2>
            References and Source:
        </h2>
        <p>
          <b>*</b> <a href="https://gcallah.github.io/DevOps/deployment/notes.html"> Some presentation notes</a><br>
          <b>*</b> <a href="https://kubernetes.io/"> kubernetes site</a><br>
          <b>*</b> <a href="https://youtu.be/PH-2FfFD2PU"> kubernetes in 5 mins</a><br>
          <b>*</b> <a href="http://paulbakker.io/kubernetes/kubernetes-static-sites/"> Kubernetes Static Site reference</a><br>
          <b>*</b> <a href="https://daemonza.github.io/2017/01/15/kubernetes-on-aws/"> Kubernetes on AWS</a><br>
          <b>*</b> <a href="https://hub.docker.com/r/openweb/git-sync/">DockerCompose</a><br>
          <b>*</b> <a href="https://github.com/dysinger/learn-minikube">DockerCompose2</a><br>
          <b>*</b> <a href="https://github.com/kubernetes/kompose">Kompose</a><br>
          <b>*</b> <a href="https://kubernetes.io/docs/user-guide/walkthrough/">Kubernetes101</a><br>
        </p>
            </div>
        </div>
    </body>
</html>
