#!/bin/bash
# : ' ' comments

if [ $# != 1 ]; then
	echo "$#"
	echo -e "\nUSAGE: ./devops-pentest.sh <target IP address> \n"
	exit
fi

echo -e "\nDo you want to perform NMAP on top 100 ports? (y/n)"
read var0

if [ "$var0" == "y" ] || [ "$var0" == "Y" ];then
	echo -e "\nNmap scan on top 100 ports started.... \n"
	nmap -sV -A --top-ports 100 $1 # > nmap_top100_$1
	echo -e  "Nmap Done...!! \n"


# insert else statement to exit the program incase of invalid input and restart the script 

fi

echo -e "\nDo you want to perform more exhaustive nmap scan? (Y/N) "
read var2

if [ "$var2" == "y" ] || [ "$var2" == "Y" ];then
	echo -e "\nExhaustive Nmap scan started...... "
	nmap -sV -A --top-ports 1000 $1 #> exhaustive_scan_$1
	echo -e "\nNmap done on top 1000 ports..!!"
else
	echo -e "\nCompleted port scanning.... moving to vulnerabilty scanner"
fi


echo -e "\nDo you want to perform nmap vulnerability test for HTTP? (Y/N)"
read var6
if [ "$var6" == "y" ] || [ "$var6" == "Y" ];then
        nmap -p 80,443 --script-args=unsafe=1 --script=http-vuln-* $1
else
	:

fi

echo "\nDEVOPS PENETRATION TESTING HAS BEEN COMPLETED"

